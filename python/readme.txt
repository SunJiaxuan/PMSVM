Constraints generation is by 'gen_constrset_adaptive' in the PM repository (\chriswbartley\PM)